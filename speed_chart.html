
<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ポケモン素早さ早見表</title>
<style>
body { font-family: sans-serif; margin:0; padding:0; background:white; }
header { display:flex; align-items:center; justify-content:space-between; padding:10px; border-bottom:1px solid #ccc; }
#menu { font-size:24px; cursor:pointer; }
#search-box { width:90%; margin:10px auto; display:block; padding:10px; font-size:16px; }
#scarf-toggle { position:fixed; top:10px; left:10px; }
#result { margin:20px; }
.speed-bar { height:20px; background:red; margin:5px 0; }
.circle { width:14px; height:14px; border:2px solid red; border-radius:50%; display:inline-block; margin-left:5px; }
footer { text-align:center; padding:20px; border-top:1px solid #ccc; margin-top:40px; }
</style>
</head>
<body>
<header>
<div id="logo">素早さ表</div>
<div id="menu">☰</div>
</header>

<div id="scarf-toggle">
<label><input type="checkbox" id="scarf"> スカーフ</label>
</div>

<input type="text" id="search-box" placeholder="ポケモン名を検索">

<div id="result"></div>

<footer>© Speed Chart</footer>

<script>
// load CSV
async function loadCSV() {
    const res = await fetch("pokemon_speeds.csv");
    const text = await res.text();
    const lines = text.trim().split("\n").slice(1);
    const map = {};
    for (const line of lines) {
        const [name, base] = line.split(",");
        map[name] = parseInt(base);
    }
    return map;
}

function calcSpeeds(base) {
    return {
        no_ev: Math.floor((base*2+0)*1/2), 
        neutral: Math.floor((base*2+63)*1/2),
        max: Math.floor((base*2+127)*1/2)
    };
}

loadCSV().then(db=>{
    document.getElementById("search-box").addEventListener("input", e=>{
        const name = e.target.value.trim();
        if(!db[name]) { document.getElementById("result").innerHTML=""; return; }
        const base = db[name];
        const sp = calcSpeeds(base);
        const scarf = document.getElementById("scarf").checked;

        let html = `<h2>${name}</h2>`;
        html += `<div>無振り: ${sp.no_ev} <span class="circle"></span></div>`;
        html += `<div>準速: ${sp.neutral} <span class="circle"></span></div>`;
        html += `<div>最速: ${sp.max} <span class="circle"></span></div>`;

        if (scarf) {
            html += `<div>無振り(スカーフ): ${Math.floor(sp.no_ev*1.5)}</div>`;
            html += `<div>準速(スカーフ): ${Math.floor(sp.neutral*1.5)}</div>`;
            html += `<div>最速(スカーフ): ${Math.floor(sp.max*1.5)}</div>`;
        }

        document.getElementById("result").innerHTML = html;
    });
});
</script>

</body>
</html>
